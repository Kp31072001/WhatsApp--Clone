(this["webpackJsonpwhatsapp-clone-kankan"]=this["webpackJsonpwhatsapp-clone-kankan"]||[]).push([[0],{69:function(e,t,c){},70:function(e,t,c){},71:function(e,t,c){},85:function(e,t,c){},86:function(e,t,c){},87:function(e,t,c){},89:function(e,t,c){"use strict";c.r(t);var a=c(2),n=c.n(a),s=c(30),i=c.n(s),r=(c(69),c(12)),o=(c(70),c(104)),j=c(102),d=(c(71),c(44)),l=c.n(d),b=c(55),h=c.n(b),u=c(45),O=c.n(u),m=c(56),p=c.n(m),x=c(57),f=c.n(x),v=c(10),g=c(33),N=g.a.initializeApp({apiKey:"AIzaSyDeeTVsHAypVkYgcQyTpjbT2AuqttibofQ",authDomain:"whatsapp-clone-kp-8964f.firebaseapp.com",projectId:"whatsapp-clone-kp-8964f",storageBucket:"whatsapp-clone-kp-8964f.appspot.com",messagingSenderId:"633912931298",appId:"1:633912931298:web:4230f64a6454695763bfbb",measurementId:"G-SDV3C68P54"}).firestore(),S=g.a.auth(),w=new g.a.auth.GoogleAuthProvider,_=N,y=c(4),C=Object(a.createContext)(),k=function(e){var t=e.reducer,c=e.initialState,n=e.children;return Object(y.jsx)(C.Provider,{value:Object(a.useReducer)(t,c),children:n})},I=function(){return Object(a.useContext)(C)};var T=function(){var e,t,c=Object(a.useState)(""),n=Object(r.a)(c,2),s=n[0],i=n[1],d=Object(a.useState)(""),b=Object(r.a)(d,2),u=b[0],m=b[1],x=Object(v.f)().roomId,N=Object(a.useState)(""),S=Object(r.a)(N,2),w=S[0],C=S[1],k=Object(a.useState)([]),T=Object(r.a)(k,2),D=T[0],E=T[1],P=I(),A=Object(r.a)(P,2),B=A[0].user;return A[1],Object(a.useEffect)((function(){x&&(_.collection("rooms").doc(x).onSnapshot((function(e){return C(e.data().name)})),_.collection("rooms").doc(x).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){return E(e.docs.map((function(e){return e.data()})))})))}),[x]),Object(a.useEffect)((function(){i(Math.floor(5e3*Math.random()))}),[x]),Object(y.jsxs)("div",{className:"chat",children:[Object(y.jsxs)("div",{className:"chat_header",children:[Object(y.jsx)(o.a,{src:"http://avatars.dicebear.com/api/human/".concat(s,".svg")}),Object(y.jsxs)("div",{className:"chat_headerInfo",children:[Object(y.jsx)("h3",{children:w}),Object(y.jsxs)("p",{children:["last seen"," ",new Date(null===(e=D[D.length-1])||void 0===e||null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toUTCString()]})]}),Object(y.jsxs)("div",{className:"chat_headerRight",children:[Object(y.jsx)(j.a,{children:Object(y.jsx)(l.a,{})}),Object(y.jsx)(j.a,{children:Object(y.jsx)(h.a,{})}),Object(y.jsx)(j.a,{children:Object(y.jsx)(O.a,{})})]})]}),Object(y.jsx)("div",{className:"chat_body",children:D.map((function(e){var t;return Object(y.jsxs)("p",{className:"chat_message ".concat(e.name===B.displayName&&"chat_receiver"),children:[Object(y.jsx)("span",{className:"chat_name",children:e.name}),e.message,Object(y.jsx)("span",{className:"chat_timestamp",children:new Date(null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toUTCString()})]})}))}),Object(y.jsxs)("div",{className:"chat_footer",children:[Object(y.jsx)(p.a,{}),Object(y.jsxs)("form",{children:[Object(y.jsx)("input",{value:u,onChange:function(e){return m(e.target.value)},placeholder:"Type a message",type:"text"}),Object(y.jsx)("button",{onClick:function(e){e.preventDefault(),console.log("You typed >>>",u),_.collection("rooms").doc(x).collection("messages").add({message:u,name:B.displayName,timestamp:g.a.firestore.FieldValue.serverTimestamp()}),m("")},type:"submit",children:"Send message"})]}),Object(y.jsx)(f.a,{})]})]})},D=(c(85),c(58)),E=c.n(D),P=c(59),A=c.n(P),B=(c(86),c(36));var F=function(e){var t,c=e.id,n=e.name,s=e.addNewChat,i=Object(a.useState)(""),j=Object(r.a)(i,2),d=j[0],l=j[1],b=Object(a.useState)(""),h=Object(r.a)(b,2),u=h[0],O=h[1];return Object(a.useEffect)((function(){c&&_.collection("rooms").doc(c).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return O(e.docs.map((function(e){return e.data()})))}))}),[c]),Object(a.useEffect)((function(){l(Math.floor(5e3*Math.random()))}),[]),s?Object(y.jsx)("div",{onClick:function(){var e=prompt("Please enter name for chat");e&&_.collection("rooms").add({name:e})},className:"sidebarChat",children:Object(y.jsx)("h2",{children:"add new chat"})}):Object(y.jsx)(B.b,{to:"/rooms/".concat(c),children:Object(y.jsxs)("div",{className:"sidebarChat",children:[Object(y.jsx)(o.a,{src:"http://avatars.dicebear.com/api/human/".concat(d,".svg")}),Object(y.jsxs)("div",{className:"sidebarChat_info",children:[Object(y.jsx)("h2",{children:n}),Object(y.jsx)("p",{children:null===(t=u[0])||void 0===t?void 0:t.message})]})]})})};var M=function(){var e=Object(a.useState)([]),t=Object(r.a)(e,2),c=t[0],n=t[1],s=I(),i=Object(r.a)(s,2),d=i[0].user;return i[1],Object(a.useEffect)((function(){var e=_.collection("rooms").onSnapshot((function(e){n(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}));return function(){e()}}),[]),Object(y.jsxs)("div",{className:"sidebar",children:[Object(y.jsxs)("div",{className:"sidebar_header",children:[Object(y.jsx)(o.a,{src:null===d||void 0===d?void 0:d.photoURL}),Object(y.jsxs)("div",{className:"sidebar_headerRight",children:[Object(y.jsx)(j.a,{children:Object(y.jsx)(E.a,{})}),Object(y.jsx)(j.a,{children:Object(y.jsx)(O.a,{})}),Object(y.jsx)(j.a,{children:Object(y.jsx)(A.a,{})})]})]}),Object(y.jsx)("div",{className:"sidebar_search",children:Object(y.jsxs)("div",{className:"sidebar_searchContainer",children:[Object(y.jsx)(l.a,{}),Object(y.jsx)("input",{placeholder:"Search or start new chat",type:"text"})]})}),Object(y.jsxs)("div",{className:"sidebar_chats",children:[Object(y.jsx)(F,{addNewChat:!0}),c.map((function(e){return Object(y.jsx)(F,{id:e.id,name:e.data.name},e.id)}))]})]})},R=c(60),U=(c(87),c(103)),V=c(50),G="SET_USER",L=function(e,t){switch(console.log(t),t.type){case G:return Object(V.a)(Object(V.a)({},e),{},{user:t.user});default:return e}};var W=function(){var e=I(),t=Object(r.a)(e,2);Object(R.a)(t[0]);var c=t[1];return Object(y.jsx)("div",{className:"login",children:Object(y.jsxs)("div",{className:"login_container",children:[Object(y.jsx)("img",{src:"https://www.freeiconspng.com/thumbs/logo-whatsapp-png/logo-whatsapp-transparent-background-22.png",alt:""}),Object(y.jsx)("div",{className:"login_text",children:Object(y.jsx)("h1",{children:"Sign in to Whatsapp"})}),Object(y.jsx)(U.a,{onClick:function(){S.signInWithPopup(w).then((function(e){c({type:G,user:e.user})})).catch((function(e){return alert(e.message)}))},children:"Sign In With Google"})]})})};var z=function(){var e=I(),t=Object(r.a)(e,2),c=t[0].user;return t[1],Object(y.jsx)("div",{className:"app",children:c?Object(y.jsx)("div",{className:"app_body",children:Object(y.jsxs)(B.a,{children:[Object(y.jsx)(M,{}),Object(y.jsxs)(v.c,{children:[Object(y.jsx)(v.a,{path:"/rooms/:roomId",children:Object(y.jsx)(T,{})}),Object(y.jsx)(v.a,{path:"/"})]})]})}):Object(y.jsx)(W,{})})},J=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,105)).then((function(t){var c=t.getCLS,a=t.getFID,n=t.getFCP,s=t.getLCP,i=t.getTTFB;c(e),a(e),n(e),s(e),i(e)}))};i.a.render(Object(y.jsx)(n.a.StrictMode,{children:Object(y.jsx)(k,{initialState:{user:null},reducer:L,children:Object(y.jsx)(z,{})})}),document.getElementById("root")),J()}},[[89,1,2]]]);
//# sourceMappingURL=main.77a9c7bc.chunk.js.map